# Windows 实机验证清单

在 Windows 10/11 环境完成以下验证：

1) 编译与发布
- [ ] `dotnet publish -r win10-x64 -c Release /p:PublishAot=true /p:PublishSingleFile=true /p:SelfContained=true -o dist` 成功，运行发布产物无 MissingMetadata/绑定问题。

2) 单实例与唤醒
- [ ] 首次启动窗口显示，二次启动重定向并弹出已有实例。
- [ ] 激活（任务栏点击/快捷方式）切换显隐，失焦自动隐藏，调试模式/环境变量可抑制隐藏。

3) UI/布局/动效
- [ ] 尺寸 600-700x500-600、无标题栏、圆角 8px、1px 边框符合预期。
- [ ] MicaAlt 可用时启用，Win10/Acrylic 不可用时平滑退为纯色无崩溃。
- [ ] EntranceThemeTransition/骨架到真实数据无闪烁；若 Tilt/骨架需补，记录。
- [ ] 列表分组呈现（目前未实现分组标题，如需展示需调整）。

4) 数据/扫描/过滤
- [ ] 启动/刷新后加载系统+用户开始菜单，关键词过滤、用户级优先去重生效。
- [ ] FSW 变更触发刷新；FSW 失效时手动刷新/重新打开仍能全量扫描。

5) 定位与多屏
- [ ] 主屏/副屏、任务栏顶部/底部/左/右，窗口定位在当前屏幕任务栏边缘附近（回退底部居中上移 48px），无越界。

6) 图标与性能
- [ ] 图标显示正常，无空白；GDI 对象不持续增长（反复打开/关闭窗口 50 次）。
- [ ] 冷启动 Activation->FirstShow 日志 ≤200ms（或记录实际值）。
- [ ] 滚动列表 60fps，内存峰值 <50MB，回落 <30MB。

7) 执行与菜单
- [ ] 左键启动正常；右键管理员运行时 UAC 取消静默；打开文件位置指向 LNK 并选中。
- [ ] 电源菜单 Sleep/Restart/Shutdown 正常或提示权限不足（记录行为）。

8) DPI/兼容
- [ ] DPI 100/150/200% 文本和图标清晰不模糊。
- [ ] Win10 虚拟机运行正常，材质自动降级，无崩溃。

9) 额外检查（编译/兼容细节）
- [ ] CsWin32 生成的 P/Invoke 命名空间与 `PositioningService` 使用的 `POINT/SHAppBarMessage` 等匹配，编译通过。
- [ ] System.Drawing 图标提取在 AOT/自包含模式下正常（无运行时异常/GDI 泄漏）。
- [ ] 多组 GridView 虚拟化性能：大列表滚动是否仍流畅；如有掉帧需启用更强虚拟化方案。
- [ ] 任务栏隐藏/垂直布局场景下定位偏移是否可接受（fallback 48px + 主任务栏高度）。
